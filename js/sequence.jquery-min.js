/*
Sequence.js (www.sequencejs.com)
Version: 0.3 Beta
Author: Ian Lunn @IanLunn
Author URL: http://www.ianlunn.co.uk/
Github: https://github.com/IanLunn/Sequence

This is a FREE script and is dual licensed under the following:
http://www.opensource.org/licenses/mit-license.php | http://www.gnu.org/licenses/gpl.html

Sequence.js and its dependencies are (c) Ian Lunn Design 2012 unless otherwise stated.
Aside from these comments, you may modify and distribute this file as you please. Have fun!
*/(function(a){function b(b,c){function h(){e.settings.nextButton=e.init.navButtons(c.nextButton,a.fn.sequence.defaults.nextButton);e.settings.prevButton=e.init.navButtons(c.prevButton,a.fn.sequence.defaults.prevButton);e.settings.prependPauseIcon=e.settings.prependPauseIcon!=undefined?e.settings.prependPauseIcon:e.container;e.hasTouch&&(e.settings.calculatedSwipeThreshold=e.container.width()*(e.settings.swipeThreshold/100));e.settings.pauseIcon=e.init.pauseIcon(e.settings.pauseIcon,e.settings.pauseIconSrc);e.currentFrame=e.sequence.children("li:nth-child("+e.settings.startingFrameID+")").addClass("current");e.currentFrameChildren=e.currentFrame.children();e.currentFrameID=e.settings.startingFrameID;e.nextFrameID=e.currentFrameID;e.sequence.children("li").children().removeClass("animate-in");e.direction;e.sequence.css({width:"100%",height:"100%"});if(e.transitionsSupported){whenFirstAnimateInEnds=function(){animationComplete=function(){e.settings.afterNextFrameAnimatesIn();e.active=!1;if(e.settings.autoPlay){autoPlaySequence=function(){e.autoPlaySequence()};clearTimeout(e.sequenceTimer);e.sequenceTimer=setTimeout(autoPlaySequence,e.settings.autoPlayDelay,e)}};e.waitForAnimationsToComplete(e.currentFrameChildren,animationComplete)};if(!e.settings.animateStartingFrameIn){e.modifyElements(e.currentFrameChildren,"0s");e.currentFrameChildren.addClass("animate-in");setTimeout(function(){e.modifyElements(e.currentFrameChildren,"")},100);if(e.settings.autoPlay){autoPlaySequence=function(){e.autoPlaySequence()};clearTimeout(e.sequenceTimer);e.sequenceTimer=setTimeout(autoPlaySequence,e.settings.autoPlayDelay,e)}}else if(e.settings.reverseAnimationsWhenNavigatingBackwards&&e.settings.autoPlayDirection-1&&e.settings.animateStartingFrameIn){e.active=!0;e.modifyElements(e.currentFrameChildren,"0s");e.currentFrameChildren.addClass("animate-out");e.settings.beforeNextFrameAnimatesIn();setTimeout(function(){e.modifyElements(e.currentFrameChildren,"");e.currentFrameChildren.removeClass("animate-out");e.currentFrameChildren.addClass("animate-in")},100);whenFirstAnimateInEnds()}else{e.active=!0;e.settings.beforeCurrentFrameAnimatesIn();setTimeout(function(){e.modifyElements(e.currentFrameChildren,"");e.currentFrameChildren.addClass("animate-in")},100);whenFirstAnimateInEnds()}}else{e.sequence.children("li").children().css("opacity","0").addClass("animate-in").animate({opacity:"1"},500);e.currentFrame.css("z-index",e.numberOfFrames);e.sequence.children(":not(li:nth-child("+e.settings.startingFrameID+"))").css({display:"none",opacity:0});if(e.settings.autoPlay){autoPlaySequence=function(){e.autoPlaySequence()};clearTimeout(e.sequenceTimer);e.sequenceTimer=setTimeout(autoPlaySequence,e.settings.autoPlayDelay,e)}}e.settings.nextButton!=undefined&&e.settings.nextButton.click(function(){e.next()});e.settings.prevButton!=undefined&&e.settings.prevButton.click(function(){e.prev()});e.settings.keysNavigate==1&&a(document).keydown(function(a){a.keyCode==39&&e.next();a.keyCode==37&&e.prev()});if(e.settings.pauseOnHover&&!e.settings.pauseOnElementsOutsideContainer&&e.settings.autoPlay){function b(b){containerLeft=e.container.position().left;containerRight=e.container.position().left+e.container.width();containerTop=e.container.position().top;containerBottom=e.container.position().top+e.container.height();pageX=b.pageX;pageY=b.pageY;if(pageX>=containerLeft&&pageX<=containerRight&&pageY>=containerTop&&pageY<=containerBottom){e.settings.autoPlay=!1;clearTimeout(e.sequenceTimer);a(e.settings.pauseIcon).show();e.sequence.unbind("mousemove")}}e.hoverEvent=e.sequence.mousemove(function(a){b(a)});e.sequence.mouseleave(function(c){e.settings.autoPlay=!0;autoPlaySequence=function(){e.autoPlaySequence()};clearTimeout(e.sequenceTimer);e.sequenceTimer=setTimeout(autoPlaySequence,e.settings.autoPlayDelay,e);a(e.settings.pauseIcon).hide();e.sequence.data("events").mousemove==undefined&&e.sequence.mousemove(function(a){b(a)})})}else e.settings.pauseOnHover&&e.settings.autoPlay&&(e.hoverEvent=e.sequence.hover(function(b){e.settings.autoPlay=!1;clearTimeout(e.sequenceTimer);a(e.settings.pauseIcon).show()},function(){e.settings.autoPlay=!0;autoPlaySequence=function(){e.autoPlaySequence()};clearTimeout(e.sequenceTimer);e.sequenceTimer=setTimeout(autoPlaySequence,e.settings.autoPlayDelay,e);a(e.settings.pauseIcon).hide()}));if(e.settings.touchEnabled&&e.hasTouch){var d,f={touchstart:-1,touchmove:-1,swipeDirection:""};e.sequence.bind("touchstart touchmove touchend",function(a){a.preventDefault();switch(a.originalEvent.type){case"touchstart":case"touchmove":f[a.originalEvent.type]=a.originalEvent.touches[0].pageX;break;case"touchend":f.touchstart>-1&&f.touchmove>e.settings.calculatedSwipeThreshold&&(f.touchstart<f.touchmove?e.next():e.prev());default:}})}a(window).resize(function(){e.settings.calculatedSwipeThreshold=e.container.width()*(e.settings.swipeThreshold/100)})}this.container=a(b);this.sequence=this.container.children("ul");try{Modernizr.prefixed;if(Modernizr.prefixed==undefined)throw"undefined"}catch(d){getModernizr()}var e=this,f={WebkitTransition:"-webkit-",MozTransition:"-moz-",OTransition:"-o-",msTransition:"-ms-",transition:""},g={WebkitTransition:"webkitTransitionEnd webkitAnimationEnd",MozTransition:"transitionend animationend",OTransition:"oTransitionEnd oAnimationEnd",msTransition:"MSTransitionEnd MSAnimationEnd",transition:"transitionend animationend"};e.prefix=f[Modernizr.prefixed("transition")];e.transitionEnd=g[Modernizr.prefixed("transition")],e.transitionProperties={},e.numberOfFrames=e.sequence.children("li").length,e.transitionsSupported=e.prefix!=undefined?!0:!1,e.hasTouch="ontouchstart"in window?!0:!1,e.sequenceTimer,e.paused=!1,e.hoverEvent,e.defaultPreloader;e.init={preloader:function(b){prependPreloaderTo=e.settings.prependPreloader==1?e.container:e.settings.prependPreloader;opacity=e.transitionsSupported?0:1;switch(b){case!0:case undefined:a("head").append("<style>#sequence-preloader{height: 100%;position: absolute;width: 100%;z-index: 999999;}@"+e.prefix+"keyframes preload{0%{opacity: 0;}50%{opacity: 1;}100%{opacity: 0;}}@keyframes preload{0%{opacity: 0;}50%{opacity: 1;}100%{opacity: 0;}}#sequence-preloader img{background: #ff9933;border-radius: 6px;display: inline-block;height: 12px;opacity: "+opacity+";position: relative;top: -50%;width: 12px;"+e.prefix+"animation: preload 1s infinite; animation: preload 1s infinite;}.preloading{height: 12px;margin: 0 auto;top: 50%;position: relative;width: 48px;}#sequence-preloader img:nth-child(2){"+e.prefix+"animation-delay: .15s; animation-delay: .15s;}#sequence-preloader img:nth-child(3){"+e.prefix+"animation-delay: .3s; animation-delay: .3s;}.preloading-complete{opacity: 0;visibility: hidden;"+e.prefix+"transition-duration: 1s; transition-duration: 1s;}</style>");a(prependPreloaderTo).prepend('<div id="sequence-preloader"><div class="preloading"><img src="images/sequence-preloader.png" alt="Sequence is loading, please wait..." />    <img src="images/sequence-preloader.png" alt="Sequence is loading, please wait..." />    <img src="images/sequence-preloader.png" alt="Sequence is loading, please wait..." /></div></div>');(!e.transitionsSupported||e.prefix=="-o-")&&e.preloaderFallback();return a("#sequence-preloader");case!1:break;default:this.CSSSelectorToHTML(a(prependPreloaderTo),b);return a(b)}},navButtons:function(b,c){prependNextButtonTo=e.settings.prependNextButton==1?e.container:e.settings.prependNextButton;prependPrevButtonTo=e.settings.prependPrevButton==1?e.container:e.settings.prependPrevButton;switch(b){case!0:case undefined:c==".next"?this.CSSSelectorToHTML(a(prependNextButtonTo),a.fn.sequence.defaults.nextButton):this.CSSSelectorToHTML(a(prependPrevButtonTo),a.fn.sequence.defaults.prevButton);break;case!1:break;default:if(c==".next"){this.CSSSelectorToHTML(a(prependNextButtonTo),b);a(b).show();return a(b)}this.CSSSelectorToHTML(a(prependPrevButtonTo),b);a(b).show();return a(b)}},pauseIcon:function(b,c){prependPauseIconTo=e.settings.prependPauseIcon==1?e.container:e.settings.prependPauseIcon;switch(b){case!0:case undefined:this.CSSSelectorToHTML(a(prependPauseIconTo),".pause-icon",c);a(".pause-icon").hide();return".pause-icon";case!1:break;default:this.CSSSelectorToHTML(a(prependPauseIconTo),e.settings.pauseIcon,c);a(e.settings.pauseIcon).hide();return a(e.settings.pauseIcon)}},CSSSelectorToHTML:function(b,c,d){switch(c.charAt(0)){case".":buttonSelector='class="'+c.split(".")[1]+'"';break;case"#":buttonSelector='id="'+c.split("#")[1]+'"';break;default:buttonSelector=c}d==undefined||e.settings.pauseIcon==1&&e.settings.pauseIcon==undefined?a(b).prepend("<div "+buttonSelector+"></div>"):a(b).prepend("<div "+buttonSelector+'><img src="'+d+'" alt="Pause" /></div>')}},e.settings=a.extend({},a.fn.sequence.defaults,c);e.settings.preloader=e.init.preloader(e.settings.preloader);if(e.settings.animateStartingFrameIn){e.modifyElements(e.sequence.children("li").children(),"0s");e.sequence.children("li").children().removeClass("animate-in")}c.preloader!=0?a(window).bind("load",function(){e.settings.afterPreload();if(e.settings.hidePreloaderUsingCSS&&e.transitionsSupported&&e.prefix!="-o-"){prependPreloadingCompleteTo=e.settings.prependPreloadingComplete==1?e.settings.preloader:a(e.settings.prependPreloadingComplete);prependPreloadingCompleteTo.addClass("preloading-complete");setTimeout(h,e.settings.hidePreloaderDelay)}else e.settings.preloader.fadeOut(e.settings.hidePreloaderDelay,function(){clearInterval(e.defaultPreloader);h()});a(window).unbind("load")}):h()}b.prototype={preloaderFallback:function(){function b(){i=i==1?0:1;a("#sequence-preloader img:nth-child(1)").animate({opacity:i},100);a("#sequence-preloader img:nth-child(2)").animate({opacity:i},350);a("#sequence-preloader img:nth-child(3)").animate({opacity:i},600)}i=0;b();self.defaultPreloader=setInterval(function(){b()},600)},autoPlaySequence:function(a){var b=this;b.settings.autoPlayDirection==1?b.next():b.prev()},modifyElements:function(a,b){var c=this;a.css(c.prefixCSS(c.prefix,{"transition-duration":b,"transition-delay":b}))},prefixCSS:function(a,b){css={};for(property in b)css[a+property]=b[property];return css},getStyleBySelector:function(a){css={};var b=document.styleSheets,c,d,e;for(d=b.length-1;d>=0;d--){error=!1;try{c=b[d].cssRules}catch(f){error=!0}if(!error)for(e=0;e<c.length;e++)if(c[e].type==CSSRule.STYLE_RULE&&c[e].selectorText==a){css["-o-transition-duration"]=c[e].style.OTransitionDuration;css["-o-transition-delay"]=c[e].style.OTransitionDelay;return css}}return null},startAutoPlay:function(b,c){var d=this;b=b==undefined?0:b;d.settings.autoPlayDelay=c==undefined?d.settings.autoPlayDelay:c;d.settings.autoPlay=!0;autoPlaySequence=function(){d.autoPlaySequence()};clearTimeout(d.sequenceTimer);d.sequenceTimer=setTimeout(autoPlaySequence,d.settings.autoPlayDelay,d);d.settings.pauseOnHover&&(d.hoverEvent=d.sequence.hover(function(){d.settings.autoPlay=!1;clearTimeout(d.sequenceTimer);a(d.settings.pauseIcon).show()},function(){d.settings.autoPlay=!0;autoPlaySequence=function(){d.autoPlaySequence()};clearTimeout(d.sequenceTimer);d.sequenceTimer=setTimeout(autoPlaySequence,d.settings.autoPlayDelay,d);a(d.settings.pauseIcon).hide()}))},stopAutoPlay:function(){var a=this;a.settings.autoPlay=!1;clearTimeout(a.sequenceTimer);a.hoverEvent!=undefined&&a.hoverEvent.unbind()},next:function(){var a=this;if(!a.active)if(a.settings.cycle||!a.settings.cycle&&a.currentFrame.index()+1!=a.numberOfFrames){if(a.paused){a.paused=!1;a.startAutoPlay()}a.nextFrameID=a.currentFrame.index()+1!=a.numberOfFrames?a.currentFrameID+1:1;a.goTo(a.nextFrameID,1)}else if(a.settings.autoPlayDirection==1){a.paused=!0;a.stopAutoPlay()}},prev:function(){var a=this;if(!a.active)if(a.settings.cycle||!a.settings.cycle&&a.currentFrame.index()+1!=1){if(a.paused){a.paused=!1;a.startAutoPlay()}a.nextFrameID=a.currentFrame.index()+1==1?a.numberOfFrames:a.currentFrameID-1;a.goTo(a.nextFrameID,-1)}else if(a.settings.autoPlayDirection==-1){a.paused=!0;a.stopAutoPlay()}},goTo:function(a,b){var c=this;a==c.numberOfFrames?c.settings.beforeLastFrameAnimatesIn():a==1&&c.settings.beforeFirstFrameAnimatesIn();if(a==c.currentFrame.index()+1)return!1;if(!c.active){c.active=!0;c.currentFrame=c.sequence.children(".current");nextFrame=c.sequence.children("li:nth-child("+a+")");b==undefined?c.direction=a>c.currentFrameID?1:-1:c.direction=b;frameChildren=c.currentFrame.children();nextFrameChildren=nextFrame.children();if(c.transitionsSupported){c.settings.beforeCurrentFrameAnimatesOut();c.animateOut(c.direction);animateIn=function(){c.animateIn(c.direction);c.currentFrameID=a};switch(c.settings.delayDuringOutInTransitions){case!0:c.waitForAnimationsToComplete(frameChildren,animateIn);break;case!1:animateIn();break;default:setTimeout(animateIn,c.settings.delayDuringOutInTransitions)}}else{c.sequence.children("li").css({position:"relative"});c.currentFrame.animate({opacity:0},c.settings.fallbackTheme.speed,function(){c.currentFrame.css({display:"none","z-index":"1"});c.currentFrame.removeClass("current");c.settings.beforeNextFrameAnimatesIn();nextFrame.addClass("current").css({display:"block","z-index":c.numberOfFrames}).animate({opacity:1},500);c.currentFrame=nextFrame;c.currentFrameID=c.currentFrame.index()+1;c.active=!1;if(c.settings.autoPlay){autoPlaySequence=function(){c.autoPlaySequence()};clearTimeout(c.sequenceTimer);c.sequenceTimer=setTimeout(autoPlaySequence,c.settings.autoPlayDelay,c)}})}}},animateOut:function(b){var c=this;c.settings.beforeCurrentFrameAnimatesIn();if(!c.settings.reverseAnimationsWhenNavigatingBackwards||b==1){c.modifyElements(nextFrameChildren,"0s");nextFrameChildren.removeClass("animate-out");c.modifyElements(frameChildren,"");c.settings.disableAnimateOut||frameChildren.addClass("animate-out").removeClass("animate-in")}if(c.settings.reverseAnimationsWhenNavigatingBackwards&&b==-1){c.modifyElements(nextFrameChildren,"0s");c.settings.disableAnimateOut?c.active=!1:nextFrameChildren.addClass("animate-out");c.modifyElements(frameChildren,"");frameChildren.each(function(){if(c.prefix=="-o-"){selector="."+a(this).attr("class").replace(" ",".");previousFrameTransitionProperties=c.getStyleBySelector(selector);c.transitionProperties["transition-duration"]=previousFrameTransitionProperties["-o-transition-duration"];c.transitionProperties["transition-delay"]=previousFrameTransitionProperties["-o-transition-delay"];c.transitionProperties["transition-delay"]=c.transitionProperties["transition-delay"]==""?"0s":c.transitionProperties["transition-delay"]}else{c.transitionProperties["transition-duration"]=a(this).css(c.prefix+"transition-duration");c.transitionProperties["transition-delay"]=a(this).css(c.prefix+"transition-delay")}a(this).css(c.prefixCSS(c.prefix,c.transitionProperties)).removeClass("animate-in")})}},waitForAnimationsToComplete:function(b,c){var d=this;elementsAnimated={};b.each(function(){elementsAnimated[a(this).attr("class")]=!1});d.currentFrame.bind(d.transitionEnd,function(a){elementsAnimated[a.target.className]=!0;total=0;for(element in elementsAnimated)elementsAnimated[element]==1&&total++;total==b.length&&c()})},animateIn:function(a){var b=this;b.currentFrame.removeClass("current");b.currentFrame.unbind(b.transitionEnd);nextFrame.addClass("current");b.currentFrame=nextFrame;a==1?b.currentFrameID=b.currentFrameID!=b.numberOfFrames?b.currentFrameID+1:1:b.currentFrameID=b.currentFrameID!=1?b.currentFrameID-1:b.numberOfFrames;nextFrameChildren=nextFrame.children();frameChildren=b.currentFrame.children();b.settings.beforeNextFrameAnimatesIn();if(!b.settings.reverseAnimationsWhenNavigatingBackwards||a==1){b.modifyElements(nextFrameChildren,"0s");nextFrameChildren.removeClass("animate-out");setTimeout(function(){frameChildren.removeClass("animate-out");b.modifyElements(frameChildren,"");frameChildren.addClass("animate-in");whenAnimationEnds()},50)}b.settings.reverseAnimationsWhenNavigatingBackwards&&a==-1&&setTimeout(function(){b.modifyElements(frameChildren,"");frameChildren.addClass("animate-in").removeClass("animate-out");whenAnimationEnds()},50);whenAnimationEnds=function(){unbind=function(){b.settings.afterNextFrameAnimatesIn();b.currentFrameID==b.numberOfFrames?b.settings.afterLastFrameAnimatesIn():b.currentFrameID==1&&b.settings.afterFirstFrameAnimatesIn();b.currentFrame.unbind(b.transitionEnd);b.active=!1;if(b.settings.autoPlay){autoPlaySequence=function(){b.autoPlaySequence()};clearTimeout(b.sequenceTimer);b.sequenceTimer=setTimeout(autoPlaySequence,b.settings.autoPlayDelay,b)}};b.waitForAnimationsToComplete(nextFrameChildren,unbind)}}};a.fn.sequence=function(c){return this.each(function(){var d=new b(a(this),c);a(this).data("sequence",d)})};getModernizr=function(){window.Modernizr=function(a,b,c){function d(a){p.cssText=a}function e(a,b){return d(prefixes.join(a+";")+(b||""))}function f(a,b){return typeof a===b}function g(a,b){return!!~(""+a).indexOf(b)}function h(a,b){for(var d in a)if(p[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function i(a,b,d){for(var e in a){var g=b[a[e]];if(g!==c)return d===!1?a[e]:f(g,"function")?g.bind(d||b):g}return!1}function j(a,b,c){var d=a.charAt(0).toUpperCase()+a.substr(1),e=(a+" "+t.join(d+" ")+d).split(" ");return f(b,"string")||f(b,"undefined")?h(e,b):(e=(a+" "+u.join(d+" ")+d).split(" "),i(e,b,c))}var k="2.5.3",l={},m=b.documentElement,n="modernizr",o=b.createElement(n),p=o.style,q,r={}.toString,s="Webkit Moz O ms",t=s.split(" "),u=s.toLowerCase().split(" "),v={},w={},x={},y=[],z=y.slice,A,B={}.hasOwnProperty,C;!f(B,"undefined")&&!f(B.call,"undefined")?C=function(a,b){return B.call(a,b)}:C=function(a,b){return b in a&&f(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if(typeof b!="function")throw new TypeError;var c=z.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(z.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(z.call(arguments)))};return d});for(var D in v)C(v,D)&&(A=D.toLowerCase(),l[A]=v[D](),y.push((l[A]?"":"no-")+A));return d(""),o=q=null,l._version=k,l._domPrefixes=u,l._cssomPrefixes=t,l.testProp=function(a){return h([a])},l.testAllProps=j,l.prefixed=function(a,b,c){return b?j(a,b,c):j(a,"pfx")},l}(this,this.document)};a.fn.sequence.defaults={nextButton:".next",prependNextButton:!0,prevButton:".prev",prependPrevButton:!0,preloader:!0,prependPreloader:!0,prependPreloadingComplete:!0,hidePreloaderUsingCSS:!0,hidePreloaderDelay:0,startingFrameID:1,autoPlay:!0,autoPlayDirection:1,animatestartingFrameIn:!1,autoPlayDelay:5e3,pauseOnHover:!0,pauseIcon:!1,prependPauseIcon:!0,pauseIconSrc:"images/pause-icon.png",keysNavigate:!0,delayDuringOutInTransitions:1e3,touchEnabled:!0,swipeThreshold:15,cycle:!0,disableAnimateOut:!1,reverseAnimationsWhenNavigatingBackwards:!0,pauseOnElementsOutsideContainer:!1,fallbackTheme:{speed:500},beforeCurrentFrameAnimatesOut:function(){},beforeNextFrameAnimatesIn:function(){},afterNextFrameAnimatesIn:function(){},beforeCurrentFrameAnimatesIn:function(){},beforeFirstFrameAnimatesIn:function(){},afterFirstFrameAnimatesIn:function(){},beforeLastFrameAnimatesIn:function(){},afterLastFrameAnimatesIn:function(){},afterPreload:function(){}};a.fn.sequence.settings={}})(jQuery);